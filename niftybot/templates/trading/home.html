{% extends 'base.html' %}

{% block title %}Home - NIFTY Trading Bot{% endblock %}

{% block extra_head %}
    <script src="https://cdn.canvasjs.com/canvasjs.min.js"></script>
{% endblock %}

{% block content %}

<style>
    :root {
        --primary: #00ff9d;
        --primary-dark: #00c978;
        --primary-light: #40ffb5;
        --background: #000000;
        --card-bg: #111111;
        --card-bg-transparent: rgba(17, 17, 17, 0.85);
        --text: #ffffff;
        --text-muted: #aaaaaa;
        --border: #333333;
        --glow: 0 0 35px rgba(0, 255, 157, 0.55);
        --green: #00ff9d;
        --green-dark: #00c978;
        --red: #ff4d4d;
        --blue: #40c0ff;
    }

    body, html {
        margin: 0;
        padding: 0;
        height: 100%;
        background: var(--background);
        color: var(--text);
        font-family: system-ui, sans-serif;
        overflow-x: hidden;
    }

    /* ================= BACKGROUND CHART ================= */
    #chartContainer {
        position: fixed;
        inset: 0;
        width: 100%;
        height: 100%;
        z-index: 1;
        pointer-events: none;
        opacity: 0.85;
    }

    #chartContainer canvas {
        opacity: 1 !important;
    }

    /* ================= TICKER ================= */
    .ticker-container {
        position: fixed;
        bottom: 10%;
        left: 0;
        width: 100%;
        height: 3rem;
        overflow: hidden;
        z-index: 2;
        pointer-events: none;
        background: linear-gradient(to right, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.6) 30%, rgba(0,0,0,0.6) 70%, rgba(0,0,0,0.9) 100%);
        border-top: 1px solid rgba(0,255,157,0.2);
        border-bottom: 1px solid rgba(0,255,157,0.2);
        backdrop-filter: blur(5px);
    }

    .ticker-wrapper {
        display: inline-flex;
        white-space: nowrap;
        animation: ticker 80s linear infinite;
    }

    .ticker-item {
        display: inline-flex;
        align-items: center;
        gap: 0.6rem;
        padding: 0 2.2rem;
        font-size: 1.05rem;
        font-weight: 500;
        color: #ccc;
        height: 100%;
        border-right: 1px solid rgba(255,255,255,0.1);
    }

    .ticker-symbol { font-weight: 700; color: #eee; min-width: 80px; }
    .ticker-price { color: #fff; font-weight: 600; min-width: 90px; }
    .ticker-change.up   { color: var(--green); min-width: 110px; }
    .ticker-change.down { color: var(--red); min-width: 110px; }

    @keyframes ticker {
        0%   { transform: translateX(0); }
        100% { transform: translateX(-50%); }
    }

    /* ================= HERO SECTION ================= */
    .hero {
        position: relative;
        z-index: 10;
        text-align: center;
        padding: 20vh 1rem 15vh;
        background: linear-gradient(180deg, rgba(0,0,0,0.9) 0%, transparent 30%);
    }

    .hero h1 {
        font-size: clamp(3.5rem, 9vw, 6rem);
        line-height: 1.05;
        margin: 0 0 0.8rem;
        background: linear-gradient(90deg, #fff, var(--primary));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-shadow: 0 0 40px rgba(0,255,140,0.3);
    }

    .tagline {
        font-size: clamp(1.25rem, 3.5vw, 1.75rem);
        opacity: 0.9;
        max-width: 900px;
        margin: 0 auto 3rem;
        line-height: 1.45;
        color: #ccc;
    }

    .btn {
        padding: 16px 42px;
        font-size: 1.2rem;
        font-weight: 600;
        border-radius: 50px;
        cursor: pointer;
        transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
        margin: 0 1rem;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        text-decoration: none;
        position: relative;
        overflow: hidden;
        border: none;
        outline: none;
        z-index: 1;
    }

    .btn-primary {
        background: linear-gradient(45deg, var(--primary), var(--primary-dark));
        color: #000;
        box-shadow: var(--glow);
    }

    .btn-primary:hover {
        transform: translateY(-4px);
        box-shadow: 0 0 60px rgba(0,255,140,0.9);
    }

    .btn-outline {
        background: transparent;
        border: 2px solid var(--primary);
        color: var(--primary);
    }

    .stats {
        margin-top: 4.5rem;
        font-size: 1.15rem;
        opacity: 0.88;
        letter-spacing: 0.5px;
        color: #aaa;
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 2rem;
    }

    .stats span {
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .stats span::before {
        content: '';
        display: inline-block;
        width: 8px;
        height: 8px;
        background: var(--primary);
        border-radius: 50%;
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.5; }
    }

    /* ================= CONTENT SECTION ================= */
    .content-below {
        position: relative;
        z-index: 10;
        background: linear-gradient(180deg, transparent, rgba(0,0,0,0.95) 5%);
        padding: 5rem 1rem 8rem;
        min-height: 100vh;
    }

    .stat-card {
        background: var(--card-bg-transparent);
        border: 1px solid var(--border);
        border-radius: 20px;
        backdrop-filter: blur(10px);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        padding: 2.5rem 2rem;
        text-align: center;
        height: 100%;
        position: relative;
        overflow: hidden;
    }

    .stat-card:hover {
        border-color: var(--primary);
        transform: translateY(-12px);
        box-shadow: 0 25px 50px rgba(0,0,0,0.5), 0 0 30px rgba(0,255,157,0.2);
    }

    .performance-chart-container {
        background: rgba(17, 17, 17, 0.92);
        border-radius: 16px;
        padding: 1.8rem;
        border: 1px solid rgba(0,255,157,0.15);
        box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        margin: 2rem 0;
    }

    .performance-chart-container h4 {
        color: var(--primary);
        margin-bottom: 1.2rem;
        text-align: center;
        font-weight: 600;
    }

    /* Responsive adjustments */
    @media (max-width: 992px) {
        .hero { padding: 18vh 1rem 12vh; }
        .ticker-container { bottom: 8%; }
    }

    @media (max-width: 768px) {
        .hero h1 { font-size: clamp(2.8rem, 10vw, 4.2rem); }
        .tagline { font-size: 1.15rem; }
        .btn { padding: 14px 32px; margin: 0.5rem; font-size: 1.05rem; }
        .stats { flex-direction: column; gap: 1.2rem; }
    }
</style>

<!-- ================= BACKGROUND CHART ================= -->
<div id="chartContainer"></div>

<!-- ================= TICKER ================= -->
<div class="ticker-container">
    <div class="ticker-wrapper">
        {% for _ in "12"|make_list %}
        <div class="ticker-item">
            <span class="ticker-symbol">NIFTY</span>
            <span class="ticker-price">24,856.40</span>
            <span class="ticker-change up">+127.65 (+0.52%)</span>
        </div>
        <div class="ticker-item">
            <span class="ticker-symbol">BANKNIFTY</span>
            <span class="ticker-price">59,820.75</span>
            <span class="ticker-change up">+380.50 (+0.64%)</span>
        </div>
        <div class="ticker-item">
            <span class="ticker-symbol">RELIANCE</span>
            <span class="ticker-price">1,480.60</span>
            <span class="ticker-change down">-18.25 (-1.22%)</span>
        </div>
        {% endfor %}
    </div>
</div>

<!-- ================= HERO SECTION ================= -->
<div class="hero">
    <h1>
        Unlock Consistent Gains with<br>
        <span style="color: var(--primary);">Smart NIFTY Algo Trading</span>
    </h1>

    <p class="tagline">
        Fully automated • Emotion-free execution • Built for serious traders who want results
    </p>

    {% if not user.is_authenticated %}
        <div style="margin: 3rem 0;">
            <a href="{% url 'signup' %}" class="btn btn-primary">
                <i class="fas fa-rocket"></i> Start Free Trial
            </a>
            <a href="{% url 'login' %}" class="btn btn-outline">
                <i class="fas fa-sign-in-alt"></i> Login
            </a>
        </div>
    {% else %}
        <div style="margin: 3rem 0;">
            <a href="{% url 'dashboard' %}" class="btn btn-primary">
                <i class="fas fa-tachometer-alt"></i> Open Dashboard
            </a>
            <a href="{% url 'algorithms' %}" class="btn btn-outline">
                <i class="fas fa-robot"></i> Activate Algo
            </a>
        </div>
    {% endif %}

    <div class="stats">
        <span>Proven Track Record</span>
        <span>Automated Precision</span>
        <span>Capital Protection Built-in</span>
    </div>
</div>

<!-- ================= HYPE PERFORMANCE SECTION ================= -->
<div class="content-below">
    <div class="container">
        <div class="performance-chart-container">
            <h4>Real Performance – Growing Strong</h4>
            <div id="performanceChart" style="height: 380px; width: 100%;"></div>
        </div>

        <div class="row mt-5">
            <div class="col-md-4 mb-4">
                <div class="stat-card">
                    <i class="fas fa-robot fa-3x mb-3 text-primary"></i>
                    <h3>Fully Automated</h3>
                    <p class="text-muted">
                        Runs 24/7 during market hours — no manual intervention needed.
                    </p>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="stat-card">
                    <i class="fas fa-shield-alt fa-3x mb-3 text-success"></i>
                    <h3>Built-in Protection</h3>
                    <p class="text-muted">
                        Smart risk controls help protect your capital in all market conditions.
                    </p>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="stat-card">
                    <i class="fas fa-chart-line fa-3x mb-3 text-info"></i>
                    <h3>Live Monitoring</h3>
                    <p class="text-muted">
                        Real-time dashboard shows exactly how your account is performing.
                    </p>
                </div>
            </div>
        </div>

        <div class="row mt-5">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h4 class="mb-0"><i class="fas fa-play-circle me-2"></i> Ready to Start?</h4>
                    </div>
                    <div class="card-body text-center py-5">
                        {% if not user.is_authenticated %}
                            <a href="{% url 'signup' %}" class="btn btn-primary btn-lg px-5 py-3">
                                <i class="fas fa-rocket me-2"></i> Create Free Account Now
                            </a>
                            <p class="text-muted mt-4">Takes less than 60 seconds • No credit card required</p>
                        {% else %}
                            <a href="{% url 'dashboard' %}" class="btn btn-primary btn-lg px-5 py-3">
                                <i class="fas fa-tachometer-alt me-2"></i> Go to Your Dashboard
                            </a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// ================= PERFORMANCE WATER-FLOW CHART =================
(function() {
    if (!window.CanvasJS) return;

    const chart = new CanvasJS.Chart("performanceChart", {
        animationEnabled: true,
        backgroundColor: "transparent",
        theme: "dark2",
        creditText: false,
        toolTip: {
            shared: true,
            content: "<strong>{name}</strong><br>Profit: ₹{y} Lakhs"
        },
        axisX: {
            lineThickness: 0,
            tickLength: 0,
            labelFormatter: function() { return ""; },
            gridThickness: 0
        },
        axisY: {
            lineThickness: 0,
            tickLength: 0,
            labelFormatter: function(e) { return "₹" + e.value.toFixed(1) + "L"; },
            gridColor: "rgba(255,255,255,0.08)",
            labelFontColor: "#888"
        },
        data: [{
            type: "splineArea",
            name: "Account Growth",
            showInLegend: false,
            color: "rgba(0, 255, 157, 0.25)",
            lineColor: "#00ff9d",
            lineThickness: 3,
            markerSize: 0,
            fillOpacity: 0.35,
            dataPoints: []
        }]
    });

    let x = 0;
    let value = 0.8; // start low
    const points = [];

    // Generate realistic growth with ups & downs
    for (let i = 0; i < 120; i++) {
        // Overall upward trend + random volatility
        value += (Math.random() * 0.35 - 0.12) + 0.08; // slight positive drift
        value = Math.max(0.5, Math.min(12.5, value)); // keep between 0.5L – 12.5L

        points.push({
            x: x++,
            y: Math.round(value * 10) / 10,
            label: "Month " + Math.ceil(i/10)
        });
    }

    chart.options.data[0].dataPoints = points;
    chart.render();

    // Optional: slight animation loop (very subtle)
    let phase = 0;
    setInterval(() => {
        phase += 0.02;
        const offset = Math.sin(phase) * 0.08;
        chart.options.data[0].dataPoints.forEach((p, i) => {
            p.y = points[i].y + offset * (1 - i/points.length);
        });
        chart.render();
    }, 180);
})();
</script>

{% endblock %}